# Lec2 Distributed File System - GFS - PART2⃣️

## 关于**强一致性**的简单讨论

对于强一致的系统，从其他程序访问时看起来就像是和单台服务器通信。尽管一个系统可能用了很多台服务器，但对外展示的就"好像"只有**一台服务器、一份数据，且系统一次只做一件事，只处理一个请求（单线程）**，这就要求服务器需要从并发的请求中挑选出来一个执行，执行完成后再执行下一个。

对于存储系统，实际上就是操作磁盘，并维护一个k-v为索引的数据表单。

为了达到强一致这个目的，需要定义一条规则：**一个时间只执行一条请求，请求顺序执行。**这样每个请求都可以看到之前所有请求执行后的新数据。

## 一个并不优秀的设计方式

> 假设有两台服务器，每个服务器都有数据的一份完整副本。且每台服务器磁盘上都存储了一个k-v表单。直观来看，这两个表单完全一致且一台故障后，可以切到另一台接受请求。
>
> 问题：
>
> 1. 写请求必须在两台都执行以保证一致性，读请求只需要在一台上执行。那么如果有两个并发写入请求，假设一个将X改为1，另一个将X改为2，都需要在打到两台服务器上，由于我们没有一个顺序的方式处理请求，两个请求分别到达两台服务器的顺序可能是不一样的，就导致第一台可能先改为了1，后改为了2；第二台先改为了2，后改为了1。最终出现一致性问题。

## GFS综述

GFS可以说是分布式系统在当时为数不多的在工业界被应用的例子之一。Google拥有远超单个磁盘容量的数据要处理，并且需要借助例如MapReduce这种工具快速处理数据。因此，Google需要能够快速的并行访问海量数据。

GFS是Google针对大型、快速的全局(Global)分布式文件系统的一种解决方案，且这个文件系统可以被不同的应用程序进行读取和访问。

特点：

* 为了获取大容量、高性能，每个包含数据的文件都会被GFS分割（Sharding）并存放在多个服务器中；
* 运行在多台服务器，我们希望可以进行自动的故障修复（Automatic Recovery）；
* GFS提出存储系统接受弱一致性，以此来提供更高的性能；
* 单Master节点进行工作。

局限性：

* 单个GFS在设计上只有一个数据中心，没有将副本保存在世界各地，但实际上多个副本应该距离相对远。
* GFS并不面向普通用户，仅供内部使用
* GFS对大型顺序文件的读写做了定制化，但对小文件读取的性能并不是很好。GFS是为TB级别的文件而生，只会进行顺序处理，不支持随机访问，其关注点在于巨大的吞吐量，单次操作都涉及到MB级别的数据。

